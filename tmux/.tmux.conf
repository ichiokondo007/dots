# prefix-keyの指定
#set -g prefix C-g
# prefix-keyの解除
# unbind-key C-b
# 設定ファイルをリロード
bind-key -T prefix r source-file ~/.tmux.conf \; display-message 'Reload'
# True Colorを使用する
set -g default-terminal "screen-256color"
set -ga terminal-overrides ",xterm-256color:Tc"
# ESCの反応を早くする
set -g escape-time 1
# 添字を1から始める
set -g base-index 1
setw -g pane-base-index 1
# マウスを有効
setw -g mouse on
# ステータスラインの更新間隔を1秒にする
set -g status-interval 1
# ウィンドウを閉じた際に番号を詰める
set -g renumber-windows on
# prefix-keyの有効時間をミリ秒で指定
# bind-key -rで指定しているkeyはprefix-keyを再度押さなくとも連続で効く
set -g repeat-time 400
# display-message
set -g display-time 1500
# focus events
set -g focus-events on

set -g @plugin 'tmux-plugins/tpm'
#run '~/.tmux/plugins/tpm/tpm'

# TPM 本体
set -g @plugin 'tmux-plugins/tpm'

# 追加したいプラグイン
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-yank'
set -g @plugin 'tmux-plugins/tmux-copycat'
set -g @plugin 'tmux-plugins/tmux-open'


# ----------------------------------------
# Key bindings
# ----------------------------------------
bind h select-pane -L 
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R
# パネルの大きさ変更ショートカットのカスタマイズ例
bind -n M-h resize-pane -L 5  # Alt-hで左に5セル分縮小
bind -n M-l resize-pane -R 5  # Alt-lで右に5セル分拡大
bind -n M-j resize-pane -D 5  # Alt-jで下に5セル分拡大
bind -n M-k resize-pane -U 5  # Alt-kで上に5セル分拡大
# コマンドプロンプト
# パネル移動ショートカットのカスタマイズ例
#bind -n M-: command-prompt -p '>>>'
#ペイン間の移動
#bind -n M-h select-pane -L
#bind -n M-j select-pane -D
#bind -n M-k select-pane -U
#bind -n M-l select-pane -R
#新しいウィンドウ(current-directoryを引き継ぐ)
#bind -n M-w new-window -c '#{pane_current_path}'
#ウィンドウ間の移動
#bind -n M-u select-window -t :-
#bind -n M-i select-window -t :+
bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9
# new-session
#bind -n M-s  command-prompt -p \
#  'new-session :' "new-session -s %% -c '#{pane_current_path}'"
# switch-client
#bind c display-message 'switch-session' \; run-shell \
#  'tmux choose-tree -s -f "##{!=:##{session_name},#{session_name}}"'
# kill-session
#bind x display-message 'kill-session' \; run-shell \
#  'tmux choose-tree -s -f "##{!=:##{session_name},#{session_name}}" \
#    "kill-session -t %%"'
#ペインの大きさを調整
#bind -r < resize-pane -L 5
#bind -r > resize-pane -R 5
#bind -r - resize-pane -D 5
#bind -r + resize-pane -U 5
#ペインを区切る(current-directoryを引き継ぐ)
#bind v split-window -h -c "#{pane_current_path}"
#bind s split-window -v -c "#{pane_current_path}"
#ペインの移動(右回り)
#bind -r N swap-pane -D
#ペインの移動(左回り)
#bind -r P swap-pane -U
#ウィンドウの削除
#bind X confirm-before -p 'kill-window #I? (y/n)' kill-window
#ペインを指定したウィンドウに移動
#bind j command-prompt -1 'join-pane -ht :%%'

# ----------------------------------------
# Aliases
# ----------------------------------------
set -s command-alias[0] exit='kill-server'
set -s command-alias[1] only='kill-session -a'
set -s command-alias[2] d='detach-client'

# ----------------------------------------
# Status
# ----------------------------------------
set -g status on
set -g status-keys vi
#window-statusの位置を中央にする
set -g status-justify centre
setw -g window-status-format ' #I.#W:#{b:pane_current_path} '
setw -g window-status-current-format ' #I.<-> '

# 左右のステータスラインの最大長を指定
set -g status-left-length 40
set -g status-right-length 80

# 右のステータスライン
# 画面の横幅で表示項目を変える。149以下で項目を減らす。tput colsで現在の画面幅がわかる。
set -g status-right \
  "#{?#{==:1,#([[ $(echo #{client_width}) -ge 150 ]] && echo 1 || echo 0)},#(${DOTFILES}/tmux/right_status.sh),#(${DOTFILES}/tmux/right_status.sh short)}"

# ----------------------------------------
# Color
# ----------------------------------------
# statusの色
set -g status-style fg=default,bg=default
# message表示時のstatus lineの色。dispaly,confirm-before -p などのコマンド出力の色
set -g message-style fg=green,reverse,bg=default
# command-promptでviのノーマルモード時のstatus lineの色。
set -g message-command-style fg=default,bg=default
# コピーモードのときに、右上に出てくる表示の色
set -g mode-style fg=black,bg=blue

# paneを区切っている線の色
set -g pane-active-border-style fg=green,bg=default
set -g pane-border-style fg=default,bg=default

# setw -g window-status-current-format で指定した文字列の色
#setw -g window-status-current-style fg='#8fa1b3',bold,bg=default
# setw -g window-status-format で指定した文字列の色
#setw -g window-status-style fg='#535b66',bold,bg=default

# window自体の色。terminalの設定ファイルではなく、ここで色を設定する。
#setw -g window-active-style fg='#c0c5ce',bg='#2b303b'
#setw -g window-style fg='#c0c5ce',bg='#27292d'

# ----------------------------------------
# Copy Mode
# ----------------------------------------
#キーバインドをviにする
setw -g mode-keys vi
bind-key -T copy-mode-vi v send-keys -X begin-selection

# tmuxのbufferとxのclipboardを連携させる
if-shell 'type xsel' \
  "bind-key -T copy-mode-vi y send-keys -X copy-pipe-and-cancel 'xsel -ib'"
if-shell 'type xsel' \
  "bind-key -T copy-mode-vi Y send-keys -X copy-pipe 'xsel -ib'"
if-shell 'type xsel' \
  "bind ] run-shell \
    'xsel -ob | xargs -0 -I{} tmux set-buffer -- {} && tmux paste-buffer'"

run '~/.tmux/plugins/tpm/tpm'
